import { botConfig } from '../conf/config';
import { FightStatisctics } from '../service/swine.service';
import { commands } from './commands';

const usrMentionMdV2 = (username: string, userId: string): string =>
  `[${escapeMdV2(username)}](tg://user?id=${userId})`;

export const escapeMdV2 = (s = ''): string => s.replace(/[_*[\]()~`>#+-=|{}.!]/gi, '\\$&');

const SYNONIMS: Record<string, string[]> = {
  swine: ['—Å–≤–∏–Ω', '–ø–æ—Ä–æ—Å–µ–Ω–æ–∫', '–º–∏–Ω–∏–ø–∏–≥', '–±–æ—Ä–æ–≤', '—à–≤–∞–π–Ω–æ–∫–∞—Ä–∞—Å—å', '—Ö—Ä—è–∫'],
  swine_genetive: ['—Å–≤–∏–Ω–∞', '–ø–æ—Ä–æ—Å–µ–Ω–∫–∞', '–º–∏–Ω–∏–ø–∏–≥–∞', '–±–æ—Ä–æ–≤–∞', '—à–≤–∞–π–Ω–æ–∫–∞—Ä–∞—Å—è'],
  swines: ['—Å–≤–∏–Ω—å–∏', '–ø–æ—Ä–æ—Å—è—Ç–∞', '–º–∏–Ω–∏–ø–∏–≥–∏', '–±–æ—Ä–æ–≤—ã', '—à–≤–∞–π–Ω–æ–∫–∞—Ä–∞—Å–∏'],
};

export const messages = Object.freeze({
  NOT_ENOUGH_WEIGHT_TO_FIGHT_MSG: (username: string, userId: string, weight: number, swineName: string) =>
    usrMentionMdV2(username, userId) +
    `, –í–∞—à ${escapeMdV2(swineName)} üêñ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π, ` +
    `—á—Ç–æ–±—ã —É—á–∞–≤—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –¥—Ä–∞–∫–∞—Ö, –≤—Å–µ–≥–æ *${weight} –∫–≥*\\. –ü–æ–∫–æ—Ä–º–∏—Ç–µ, —á—Ç–æ–±—ã –æ–Ω –ø–æ–¥—Ä–æ—Å */feed*\\.\n` +
    `–ù–µ–æ–±—Ö–æ–¥–∏–º–∞—è –º–∞—Å—Å–∞ –¥–ª—è —É—á–∞—Å—Ç–∏—è: *${botConfig.MIN_FIGHT_WEIGHT} –∫–≥\\.*`,

  FIGHT_TIMEOUT_MSG: (username: string, userId: string, h: number, m: number): string =>
    usrMentionMdV2(username, userId) +
    `, –í–∞—à –±–æ—Ä–æ–≤ —É–∂–µ –¥—Ä–∞–ª—Å—è –∑–∞ ` +
    `–ø–æ—Å–ª–µ–¥–Ω–∏–µ *${botConfig.SWINE_FIGHT_TIMEOUT} —á\\.*\n` +
    messages.NEXT_FIGHT_TIME_MSG([h, m]),
  FIGHTER_MSG: (username: string, userId: string, name: string, weight: number): string =>
    usrMentionMdV2(username, userId) + `, –ë–æ–µ—Ü –≤ –ø—Ä–∞–≤–æ–º —É–≥–ª—É: üê∑ *${escapeMdV2(name)}, ${weight} –∫–≥\\.*`,
  DRAW_MSG: (username: string, userId: string, name: string, weight: number): string =>
    messages.FIGHTER_MSG(username, userId, name, weight) + `\n *–ù–∏—á—å—è*, –æ–±–∞ —Å–≤–∏–Ω–∞ —Å—Ä–∞–∂–∞–ª–∏—Å—å –¥–æ—Å—Ç–æ–π–Ω–æ\\!üí™`,
  FIGHT_RES_MSG: (
    username: string,
    userId: string,
    name: string,
    weight: number,
    wName: string,
    lName: string,
    weightChange: number,
  ): string =>
    messages.FIGHTER_MSG(username, userId, name, weight) +
    `\n–ü–æ—Ä–æ—Å–µ–Ω–æ–∫ *${escapeMdV2(wName)}* –Ω–µ –æ—Å—Ç–∞–≤–∏–ª —à–∞–Ω—Å–∞ —Å–≤–∏–Ω—É *${escapeMdV2(lName)}*\\. ` +
    `–û—Ç–≥—Ä—ã–∑ –æ—Ç –Ω–µ–≥–æ *${weightChange} –∫–≥*\\. —Å–∞–ª–∞\\! ` +
    '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è\\!üëè',
  FIGHT_START_MSG: (username: string, userId: string, name: string, weight: number) =>
    usrMentionMdV2(username, userId) +
    ` –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–æ–µ–¥–∏–Ω–æ–∫\\! –ë–æ–µ—Ü –≤ –ª–µ–≤–æ–º —É–≥–ª—É: üê∑ *${escapeMdV2(name)}, ${weight} –∫–≥\\.*`,
  ACCEPT_FIGHT_MSG: (username: string, userId: string) => usrMentionMdV2(username, userId) + ` –ø—Ä–∏–Ω—è–ª –≤—ã–∑–æ–≤\\!`,
  NO_SUCH_COMMAND: (command: string): string => `–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–º–∞–Ω–¥–µ *${command}*`,
  BOT_DESCRIPTION_MSG: '–¢–µ–ª–µ–≥—Ä–∞–º\\-–±–æ—Ç *swinebot*\\. –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—Ä–∞—â–∏–≤–∞—Ç—å ' + '—Å–≤–∏–Ω–µ–π –≤ ' + `—Ç–µ–ª–µ–≥—Ä–∞–º\\-—á–∞—Ç–µ\\.`,
  COMMAND_INFORMATION: `*/${commands.HELP} <command_name>* \\- –ø–æ–º–æ—â—å –ø–æ –∫–æ–º–∞–Ω–¥–µ`,
  SPECIFY_NAME: '–ò–º—è —à–≤–∞–π–Ω–æ–∫–∞—Ä–∞—Å—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º',
  TOO_LARGE_NAME_MSG: `–ò–º—è —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ! –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: *${botConfig.MAX_NAME_LENGTH}*`,
  SWINE_CREATION_MSG: (name: string): string =>
    `–û–≥–æ —É –≤–∞—Å —Ä–æ–¥–∏–ª—Å—è —Å–≤–∏–Ω üêñ\\! –ï–≥–æ –∑–æ–≤—É—Ç: *${escapeMdV2(name)}*,` + ` *${botConfig.SWINE_DEFAULT_WEIGHT} –∫–≥\\.*`,
  SWINE_WEIGHT_MSG: (weight: string): string => `–í–µ—Å –≤–∞—à–µ–≥–æ –ø–æ—Ä–æ—Å–µ–Ω–∫–∞ üê∑: *${weight} –∫–≥\\.*`,
  SWINE_RENAME_MSG: (name: string): string => `–¢–µ–ø–µ—Ä—å –≤–∞—à–µ–≥–æ üê∑ —Å–≤–∏–Ω–∞ –∑–æ–≤—É—Ç: *${escapeMdV2(name)}*`,
  SWINE_WEIGHT_CHANGE_MSG: (
    name: string,
    weightChange: number,
    weight: number,
    username: string,
    userId: string,
  ): string => {
    return (
      usrMentionMdV2(username, userId) +
      `, –í—ã –ø–æ–∫–æ—Ä–º–∏–ª–∏ –≤–∞—à–µ–≥–æ —Å–≤–∏–Ω–∞\\. –í–∞—à üêñ *${escapeMdV2(name)}* ` +
      `${weightChange > 0 ? messages.GAIN : messages.LOSS}` +
      ` –Ω–∞ *${Math.abs(weightChange)} –∫–≥* —Å–∞–ª–∞\\. –¢–µ–ø–µ—Ä—å –æ–Ω –≤–µ—Å–∏—Ç *${weight} –∫–≥*`
    );
  },
  SWINE_FEED_TIMEOUT_MSG: (h: number, min: number): string =>
    '–í—ã —É–∂–µ –∫–æ—Ä–º–∏–ª–∏ —Å–≤–æ–µ–≥–æ üêΩ —Ö—Ä—è–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ ' +
    `*${botConfig.SWINE_FEED_TIMEOUT} —á\\.*\n` +
    messages.NEXT_FEED_TIME_MSG([h, min]),
  SWINE_NOT_EXISTS_MSG: (username: string, userId: string): string =>
    usrMentionMdV2(username, userId) +
    `, –£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç —Ö—Ä—è–∫–∞\\! –ù–∞–ø–∏—à–∏—Ç–µ /${commands.NAME} ` +
    `–∏–ª–∏ /${commands.FEED}\\, —á—Ç–æ–±—ã –æ–Ω —Ä–æ–¥–∏–ª—Å—è\\.`,
  ACCEPTED_INVALID_FIGHT_MSG: (username: string, userId: string): string =>
    usrMentionMdV2(username, userId) + `, –í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–Ω—è—Ç—å –≤—ã–∑–æ–≤\\. –ë–æ–π —É–∂–µ —Å–æ—Å—Ç–æ—è–ª—Å—è`,
  ACCEPTED_INVALID_FIGHT_SESS_MSG: (username: string, userId: string): string =>
    usrMentionMdV2(username, userId) + `, –°–µ—Å—Å–∏—è —É—Å—Ç–∞—Ä–µ–ª–∞, –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–Ω—è—Ç—å –±–æ–π`,
  SELF_FIGHT_MSG: '–í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –ø—Ä–∏–Ω—è—Ç—å –≤—ã–∑–æ–≤ –æ—Ç —Å–∞–º–æ–≥–æ —Å–µ–±—è',
  LOSS: '–ø–æ—Ö—É–¥–µ–ª',
  GAIN: '–ø–æ–ø—Ä–∞–≤–∏–ª—Å—è',

  TOP_WEIGHT_MSG: (chatName: string): string => `üê∑–¢–æ–ø —à–≤–∞–π–Ω–æ–∫–∞—Ä–∞—Å–µ–π –±–µ—Å–µ–¥—ã *${escapeMdV2(chatName)}*üê∑: \n`,
  TOP_FIGHT_MSG: (chatName: string): string => `üê∑üí™–¢–æ–ø –≤–æ–∏–Ω–æ–≤ –±–µ—Å–µ–¥—ã *${escapeMdV2(chatName)}*üê∑: \n`,
  TOP_LVL_MSG: (chatName: string): string => `üÜô –¢–æ–ø —Å–∞–º—ã—Ö –æ–ø—ã—Ç–Ω—ã—Ö —Å–≤–∏–Ω–æ–≤ –±–µ—Å–µ–¥—ã *${escapeMdV2(chatName)}*üê∑: \n`,

  TOP_WEIGHT_ROW_MSG: (pos: number, name: string, weight: number): string =>
    `*${pos}*\\. ${escapeMdV2(name)} \\- *${weight} –∫–≥*\n`,
  TOP_FIGHT_ROW_MSG: (pos: number, name: string, points: number, win: number, loss: number, draw: number): string =>
    `*${pos}*\\. ${escapeMdV2(name)} \\- *${escapeMdV2(points.toString())} –æ—á\\.* –≤\\/–Ω\\/–ø: ${win}\\/${draw}\\/${loss}\n`,
  TOP_LVL_ROW_MSG: (pos: number, name: string, lvl: number): string =>
    `*${pos}*\\. ${escapeMdV2(name)} \\- *${lvl} —É—Ä\\.*\n`,

  TOP_ROW_OWNERS_WEIGHT_MSG: (pos: number, name: string, weight: number, userFirstName: string): string =>
    `*${pos}*\\. ${escapeMdV2(name)} \\- *${weight} –∫–≥*, \\- *${escapeMdV2(userFirstName)}*\n`,
  TOP_ROW_OWNERS_FIGHT_MSG: (
    pos: number,
    name: string,
    points: number,
    win: number,
    loss: number,
    draw: number,
    userFirstName: string,
  ): string =>
    `*${pos}*\\. ${escapeMdV2(name)} \\- *${escapeMdV2(points.toString())} –æ—á\\.* –≤\\/–Ω\\/–ø: ${win}\\/${draw}\\/${loss}\\- *${escapeMdV2(
      userFirstName,
    )}*\n`,
  TOP_ROW_OWNERS_LVL_MSG: (pos: number, name: string, lvl: number, userFirstName: string): string =>
    `*${pos}*\\. ${escapeMdV2(name)} \\- *${lvl} —É—Ä\\.*, \\- *${escapeMdV2(userFirstName)}*\n`,

  SWINE_DELETE_MSG: '–í–∞—à –ø–æ—Ä–æ—Å–µ–Ω–æ–∫ –±—ã–ª —É–±–∏—Ç\\. –ü–æ–º—è–Ω–µ–º',
  SWINE_STATS_MSG: (
    name: string,
    weight: number,
    mWeight: number,
    hm: [number, number],
    fhm: [number, number],
    fightStats: FightStatisctics,
    lvl: number,
    wir: number,
    dir: number,
    lir: number,
    mwir: number,
    mdir: number,
    mlir: number,
    fedTimes: number,
  ): string =>
    messages.SWINE_MSG(name, lvl, weight) +
    messages.MAX_WEIGHT_MSG(mWeight) +
    messages.FED_TIMES_MSG(fedTimes) +
    messages.NEXT_FEED_TIME_MSG(hm) +
    messages.NEXT_FIGHT_TIME_MSG(fhm) +
    messages.FIGHT_STAT_MSG(fightStats) +
    messages.IN_ROW_MSG(wir, dir, lir) +
    messages.STREAKS_MSG(mwir, mdir, mlir),
  SWINE_INFO_MSG: (
    name: string,
    weight: number,
    mWeight: number,
    hm: [number, number],
    fhm: [number, number],
    fightStats: FightStatisctics,
    lvl: number,
  ): string =>
    messages.SWINE_MSG(name, lvl, weight) +
    messages.NEXT_FEED_TIME_MSG(hm) +
    messages.NEXT_FIGHT_TIME_MSG(fhm) +
    messages.FIGHT_STAT_MSG(fightStats) +
    messages.MAX_WEIGHT_MSG(mWeight),
  CHANNEL_IS_NOT_ALLOWED_MSG: '–ë–æ—Ç –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤, –≤—Å–µ–º –ø–æ–∫–∞',
  STREAKS_MSG: (mwir: number, mdir: number, mlir: number): string => `–°—Ç—Ä–∏–∫–∏ \\- ${mwir}\\/${mdir}\\/${mlir}\n`,
  SWINE_MSG: (name: string, lvl: number, weight: number): string =>
    `–®–≤–∞–π–Ω–æ–∫–∞—Ä–∞—Å—å üêΩ *${escapeMdV2(name)}* *${lvl} —É—Ä\\.*, *${weight}* –∫–≥\\.\n`,
  FED_TIMES_MSG: (ft: number): string => `–ü–æ–∫–æ—Ä–º–ª–µ–Ω *${ft}* —Ä–∞–∑\n`,
  MAX_WEIGHT_MSG: (mw: number): string => `–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å \\- *${mw} –∫–≥*\n`,
  IN_ROW_MSG: (wir: number, dir: number, lir: number): string =>
    `–ü–æ–¥—Ä—è–¥ ${wir != 0 ? '–ø–æ–±–µ–¥' : dir != 0 ? '–Ω–∏—á—å–∏—Ö' : '–ø–æ—Ä–∞–∂–µ–Ω–∏–π'} \\- ` +
    `${wir != 0 ? wir : dir != 0 ? dir : lir},\n`,
  NEXT_FIGHT_TIME_MSG: (hm: [number, number]): string =>
    `–°–ª–µ–¥—É—é—â–∞—è –±–∏—Ç–≤–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ *${hm[0]} —á\\. ${hm[1]} –º–∏–Ω\\.*\n`,
  NEXT_FEED_TIME_MSG: (hm: [number, number]): string => `–î–æ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–∫–æ—Ä–º–∫–∏ *${hm[0]} —á\\. ${hm[1]} –º–∏–Ω*\\.\n`,
  FIGHT_STAT_MSG: (fightStats: FightStatisctics): string =>
    `–°–≤–∏–Ω –ø–æ—É—á–∞–≤—Å—Ç–≤–æ–≤–∞–ª –≤ *${fightStats.win + fightStats.loss + fightStats.draw}* —Å—Ä–∞–∂–µ–Ω–∏—è—Ö\\.\n` +
    `–ò–∑ –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã–∏–≥—Ä–∞–ª: *${fightStats.win}*, –ø—Ä–æ–∏–≥—Ä–∞–ª: *${fightStats.loss}*\n`,
  FIGHT_ALREADY_STARTED: (username: string, userId: string): string =>
    usrMentionMdV2(username, userId) + ` —É–∂–µ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–∞ –±–∏—Ç–≤—É, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–∏–Ω—è—Ç—å –µ–≥–æ –≤—ã–∑–æ–≤\\!`,
  SWINE_ABOUT_TO_DIE: (swineWOwner: SwinesOwners): string =>
    usrMentionMdV2(swineWOwner.username, swineWOwner.userId) +
    `, –í–∞—à —Å–≤–∏–Ω *${escapeMdV2(swineWOwner.name)}* –ø—Ä–∏ —Å–º–µ—Ä—Ç–∏, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ –ø–æ–∫–æ—Ä–º–∏—Ç—å, —Ç–æ —á–µ—Ä–µ–∑` +
    ` *${botConfig.MINUTES_BEFORE_CLEAN} –º–∏–Ω\\.* –æ–Ω —É–º—Ä–µ—Ç üíÄ\n`,
  SWINE_NOT_FED_LW_MSG: (swineWOwner: SwinesOwnersLW): string =>
    usrMentionMdV2(swineWOwner.username, swineWOwner.userId) +
    `, –í—ã –Ω–µ –∫–æ—Ä–º–∏–ª–∏ —Å–≤–æ—é —Å–≤–∏–Ω—å—é üêΩ ${escapeMdV2(swineWOwner.name)} –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è, –æ–Ω` +
    ` –Ω–∞—á–∞–ª —Ö—É–¥–µ—Ç—å –∏ ` +
    `–ø–æ—Ç–µ—Ä—è–ª ${swineWOwner.wc} –∫–≥\\. –≤–µ—Å–∞\\. –¢–µ–ø–µ—Ä—å –ø–æ—Ä–æ—Å–µ–Ω–æ–∫ –≤–µ—Å–∏—Ç *${swineWOwner.weight} –∫–≥\\.*` +
    ` –ï—Å–ª–∏ –Ω–µ –∫–æ—Ä–º–∏—Ç—å —Å–≤–∏–Ω–∞, –æ–Ω –º–æ–∂–µ—Ç –ø–æ–≥–∏–±–Ω—É—Ç—å\n`,
  SWINES_ABOUT_TO_DIE_ROW: (r: SwinesOwners): string =>
    usrMentionMdV2(r.username, r.userId) + `, —Å–≤–∏–Ω *${escapeMdV2(r.name)}*\n`,
  SWINES_ABOUT_TO_DIE: (rows: SwinesOwners[]): string =>
    `${rows.length} –ø–æ—Ä–æ—Å—è—Ç –ø—Ä–∏ —Å–º–µ—Ä—Ç–∏, —É–º—Ä—É—Ç —á–µ—Ä–µ–∑ 15 –º–∏–Ω—É—Ç\\:\n` +
    rows.map(r => messages.SWINES_ABOUT_TO_DIE_ROW(r)).join('') +
    '\n',
  SWINES_NOT_FED_LW_ROW: (r: SwinesOwnersLW): string =>
    usrMentionMdV2(r.username, r.userId) +
    `, —Å–≤–∏–Ω *${escapeMdV2(r.name)}* *${r.weight} –∫–≥\\.* –ø–æ—Ç–µ—Ä—è–ª *${r.wc} –∫–≥\\.*\n`,
  SWINES_NOT_FED_LW: (rows: SwinesOwnersLW[]): string =>
    `${rows.length} —Å–≤–∏–Ω–µ–π –Ω–µ –∫–æ—Ä–º–∏–ª–∏ –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è, –æ–Ω–∏ –Ω–∞—á–∞–ª–∏ —Ç–µ—Ä—è—Ç—å –≤–µ—Å\\:\n` +
    rows.map(r => messages.SWINES_NOT_FED_LW_ROW(r)).join('') +
    '\n',
  CANNOT_FEED_WHEN_FIGHT_STARTED: '–í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –∫–æ—Ä–º–∏—Ç—å —Å–≤–æ–µ–≥–æ —Å–≤–∏–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –æ–∂–∏–¥–∞–µ—Ç —Å—Ä–∞–∂–µ–Ω–∏—è',
  DEAD_SWINES: (name: string): string => `–ü–æ—Ä–æ—Å–µ–Ω–æ–∫ *${escapeMdV2(name)}* —Ç—Ä–∞–≥–∏—á–µ—Å–∫–∏ —Å–∫–æ–Ω—á–∞–ª—Å—è\\. –í–µ—á–Ω–∞—è –ø–∞–º—è—Ç—å\\!üïØÔ∏è`,
  ONLY_BEGINNER_CAN_DECLINE: (username: string, userId: string): string =>
    usrMentionMdV2(username, userId) + ', –¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—Ä–æ—Å–∏–≤—à–∏–π –≤—ã–∑–æ–≤ –º–æ–∂–µ—Ç –µ–≥–æ –æ—Ç–º–µ–Ω–∏—Ç—å',
  FIGHT_DECLINED: '–ë–æ–π –æ—Ç–º–µ–Ω–µ–Ω',
  CANNOT_DECLINE_DONE_FIGHT: (username: string, userId: string): string =>
    usrMentionMdV2(username, userId) + `, –í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å –≤—ã–∑–æ–≤\\. –ë–æ–π —É–∂–µ —Å–æ—Å—Ç–æ—è–ª—Å—è`,
});

export type SwinesOwners = {
  userId: string;
  username: string;
  name: string;
};

export type SwinesOwnersLW = SwinesOwners & {
  wc: number;
  weight: number;
};
